<ion-header>
  <ion-toolbar>
    <ion-title>Adhésion au Café</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid>
    <ion-row>
      <ion-col size="12">
        <h1>Formulaire d'adhésion à l'association La Clé Du Quai</h1>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="6" offset="3">
        <ion-card class="form__container">
          <ion-card-content>
            <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
            <div class="form__response" *ngIf="formSentSuccess">
              <p>Merci, votre adhésion a bien été prise en compte.</p>
              <ion-button color="primary" type="button" (click)="onReload()">
                Terminé !
              </ion-button>
            </div>
            <div *ngIf="formSentFail" class="form__response">
              <p>Désolé, une erreur s'est produite. Veuillez réessayer.</p>
              <ion-button type="button" color="primary" (click)="onReload()">
                S'inscrire
              </ion-button>
            </div>
            <form
              *ngIf="!isLoading && !hideForm"
              class="subscription-form"
              [formGroup]="subscriptionForm"
              (ngSubmit)="onSubmit()"
            >
              <ion-item class="form-control">
                <ion-label position="stacked">Nom</ion-label>
                <ion-input
                  type="text"
                  name="lastName"
                  formControlName="lastName"
                  required
                ></ion-input>
              </ion-item>
              <p
                class="error-message"
                [ngClass]="subscriptionForm.get('lastName').invalid && subscriptionForm.get('lastName').touched ? 'show-error': ''"
              >
                Veuillez renseigner votre nom
              </p>
              <ion-item class="form-control">
                <ion-label position="stacked">Prénom</ion-label>
                <ion-input
                  type="text"
                  name="firstName"
                  formControlName="firstName"
                  required
                ></ion-input>
              </ion-item>
              <p
                [ngClass]="subscriptionForm.get('firstName').invalid && subscriptionForm.get('firstName').touched ? 'show-error' : ''"
                class="error-message"
              >
                Veuillez renseigner votre prénom
              </p>
              <ion-item class="form-control">
                <ion-label position="stacked">Email</ion-label>
                <ion-input
                  type="email"
                  name="email"
                  formControlName="email"
                  required
                ></ion-input>
              </ion-item>
              <p
                class="error-message"
                [ngClass]="subscriptionForm.get('email').invalid && subscriptionForm.get('email').touched ? 'show-error': ''"
              >
                Veuillez renseigner votre email
              </p>
              <ion-item>
                <ion-checkbox
                  slot="start"
                  formControlName="newsletterSubscription"
                ></ion-checkbox>
                <p>Je souhaite m'inscrire à la newsletter de La Clé du Quai</p>
              </ion-item>
              <p class="price">Adhésion à prix libre</p>
              <ion-button
                class="submit-btn"
                type="submit"
                color="primary"
                [disabled]="subscriptionForm.invalid"
              >
                Valider
              </ion-button>
            </form>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
